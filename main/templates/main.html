{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReadMe - The Future of Book Search</title>
    <link rel="stylesheet" href="{% static 'css/main_style.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="popup" >
        <div class="popup-header">Pemberitahuan</div>
        <p>Anda tidak bisa mengakses fitur ini. Untuk mengakses fitur yang lebih banyal, Harap login terlebih dahulu</p>
        <div class="abc">
            <button class="close-btn">Close</button>
            <a href="{% url 'main:login' %}">
                <button class="login-btn">Login</button>
            </a>
        </div>
    </div>
    <header class="main-header">
        <div class="logo">ReadMe</div>
        <nav class="main-nav">
            {% if user.is_authenticated %}
                <a href="{% url 'main:logout' %}" class="logout-btn">Logout</a>
                <a href="{% url 'listBook:show_list' %}">Book List</a>
                <a href="{% url 'wishlistBook:show_wishlist' %}">Saved</a>
            {% endif %}
            {% if not user.is_authenticated %}
                <div class="show-login">
                    <a href="#">Book List</a>
                    <a href="#">Saved</a>
                </div>
                <a href="{% url 'main:register' %}" class="signup-btn">Sign up</a>
                <a href="{% url 'main:login' %}" class="login-btn" style="color: #0A74DA;">Login</a>
            {% endif %}
        </nav>
        {% if user.is_authenticated %}
            <a href="#">
                <div id="profile">{{ name }}</div>
            </a>
        {% endif %}
    </header>
    <div class="background-animation"></div>
    <div class="container">
        <h1 class="tagline">AI-Powered Book Discovery.</h1>
        <div class="search-bar">
            <input type="text" placeholder="Contoh: saya anak smp, saya perlu buku mtk" id="searchInput">
            <button id="searchBtn">Search</button>
        </div>

        <div id="searchResults" class="search-results"></div>
    </div>

    <div id="bookModal" class="book-modal">
        <div class="book-list">
            <!-- The book details will be appended here using JS -->
        </div>
        <button class="close-modal" onclick="closeModal()">Close</button>
    </div>

    <script src="{% static 'js/main_script.js' %}"></script>
    <script>
    let placeholders = ["saya lagi sedih, kasih saya rekomendasi buku", "saya anak SMA, saya mau belajar ngoding python", "aku mau buku tentang spy dan misteri!"];
    let count = 0;
    let index = 0;
    let currentText = '';
    let letter = '';
    let isDeleting = false;

    (function type(){    
        if(count === placeholders.length){
            count = 0;
        }
        currentText = placeholders[count];
        if (!isDeleting) {
            letter = currentText.slice(0, ++index);
            if(letter.length === currentText.length){
                isDeleting = true;
                setTimeout(type, 1000); //delay sebelum delete
            } else {
                setTimeout(type, 50); //speed typing                         
            }
        } else {
            letter = currentText.slice(0, --index);
            if(letter.length === 0) {
                isDeleting = false;
                count++;
            }
            setTimeout(type, 50); //speed delete
        }
        document.querySelector('#searchInput').placeholder = letter;
    }());

    document.getElementById("searchBtn").addEventListener("click", function() {
  let query = document.getElementById("searchInput").value;
  if(query) {
      // Fungsi untuk membuat permintaan ke server akan didefinisikan di main_script.js
      searchBooks(query);
  }
});
        </script>
</body>
</html>